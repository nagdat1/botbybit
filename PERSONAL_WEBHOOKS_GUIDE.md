# دليل استخدام روابط الإشارة الشخصية

## نظرة عامة
كل مستخدم في البوت لديه رابط webhook خاص به لاستقبال إشارات التداول من TradingView أو أي منصة إشارات أخرى.

## الحصول على رابط الإشارة الشخصي

### الطريقة 1: من قائمة الإعدادات
1. افتح البوت `/start`
2. اضغط على **⚙️ الإعدادات**
3. اختر **📡 رابط الإشارة الشخصي**
4. سيظهر لك رابطك الخاص

### الطريقة 2: من القائمة الرئيسية
1. افتح البوت `/start`
2. اضغط على **📡 رابط الإشارة الشخصي** (إذا كان موجوداً في القائمة الرئيسية)

## شكل رابط الإشارة الشخصي

```
https://your-domain.com/personal/{USER_ID}/webhook
```

مثال:
```
https://botbybit.railway.app/personal/123456789/webhook
```

حيث `123456789` هو معرف Telegram الخاص بك.

## إعداد الإشارات في TradingView

### 1. إنشاء تنبيه جديد
- افتح TradingView
- اضغط على أيقونة **Alert** (⏰)
- اختر **Create Alert**

### 2. إعداد Webhook URL
في قسم **Notifications**:
- فعّل خيار **Webhook URL**
- الصق رابط الإشارة الشخصي الخاص بك

### 3. إعداد رسالة التنبيه
في حقل **Message**، أدخل JSON بالصيغة التالية:

```json
{
  "symbol": "{{ticker}}",
  "action": "BUY",
  "price": {{close}}
}
```

أو للبيع:
```json
{
  "symbol": "{{ticker}}",
  "action": "SELL",
  "price": {{close}}
}
```

### 4. حفظ التنبيه
- اضغط على **Create**
- سيتم إرسال الإشارة تلقائياً عند تفعيل التنبيه

## صيغ الإشارات المدعومة

### الصيغة الأساسية
```json
{
  "symbol": "BTCUSDT",
  "action": "BUY"
}
```

### مع السعر (اختياري)
```json
{
  "symbol": "BTCUSDT",
  "action": "BUY",
  "price": 50000
}
```

### مع معلومات إضافية
```json
{
  "symbol": "BTCUSDT",
  "action": "BUY",
  "price": 50000,
  "timeframe": "1h",
  "strategy": "My Strategy"
}
```

## الحقول المطلوبة

| الحقل | مطلوب | الوصف | القيم المسموحة |
|------|------|-------|----------------|
| `symbol` | ✅ | رمز العملة | BTCUSDT, ETHUSDT, إلخ |
| `action` | ✅ | نوع الصفقة | BUY, SELL |
| `price` | ❌ | السعر | رقم عشري |

## أمثلة عملية

### مثال 1: إشارة شراء بسيطة
```json
{
  "symbol": "BTCUSDT",
  "action": "BUY"
}
```

### مثال 2: إشارة بيع مع السعر
```json
{
  "symbol": "ETHUSDT",
  "action": "SELL",
  "price": 3000.50
}
```

### مثال 3: استخدام متغيرات TradingView
```json
{
  "symbol": "{{ticker}}",
  "action": "{{strategy.order.action}}",
  "price": {{close}},
  "time": "{{time}}"
}
```

## اختبار رابط الإشارة

### باستخدام cURL
```bash
curl -X POST https://your-domain.com/personal/123456789/webhook \
  -H "Content-Type: application/json" \
  -d '{
    "symbol": "BTCUSDT",
    "action": "BUY",
    "price": 50000
  }'
```

### باستخدام Postman
1. افتح Postman
2. اختر **POST**
3. أدخل رابط الإشارة الشخصي
4. في **Body** اختر **raw** و **JSON**
5. أدخل JSON للإشارة
6. اضغط **Send**

### الرد المتوقع
```json
{
  "status": "success",
  "message": "Personal signal received for user 123456789",
  "user_id": 123456789
}
```

## الفرق بين الإشارة العامة والشخصية

### الإشارة العامة (`/webhook`)
- تُرسل لجميع المستخدمين النشطين
- تستخدم للإشارات المشتركة
- الرابط: `https://your-domain.com/webhook`

### الإشارة الشخصية (`/personal/{user_id}/webhook`)
- تُرسل لمستخدم واحد فقط
- مخصصة لكل مستخدم
- الرابط: `https://your-domain.com/personal/{user_id}/webhook`

## الأمان والخصوصية

### ⚠️ نصائح أمنية

1. **لا تشارك رابطك**: رابط الإشارة الشخصي خاص بك فقط
2. **لا تنشره علناً**: لا تضع الرابط في منتديات أو مواقع عامة
3. **راقب الإشارات**: تأكد من الإشارات التي تستقبلها
4. **استخدم حساب تجريبي**: للاختبار استخدم الحساب التجريبي أولاً

### 🔒 ميزات الأمان

- كل مستخدم لديه معرف فريد
- الإشارات تُعالج فقط إذا كان المستخدم نشطاً
- تحقق من صحة البيانات قبل التنفيذ
- تسجيل جميع الإشارات للمراجعة

## استكشاف الأخطاء

### المشكلة: "No data received"
**الحل**: تأكد من أن JSON صحيح وأنك ترسل Content-Type: application/json

### المشكلة: "User not active"
**الحل**: تأكد من أن البوت مفعّل في الإعدادات

### المشكلة: "Symbol not found"
**الحل**: 
- تأكد من صحة رمز العملة (BTCUSDT وليس BTC/USDT)
- تأكد من أن الرمز متوفر في نوع السوق المحدد

### المشكلة: لا يتم تنفيذ الإشارة
**الأسباب المحتملة**:
1. المستخدم غير نشط (تحقق من الإعدادات)
2. رمز العملة غير صحيح
3. نوع الإشارة (BUY/SELL) غير صحيح
4. رابط الإشارة غير صحيح

## مراقبة الإشارات

### في البوت
- ستحصل على إشعار فوري عند استقبال إشارة
- يمكنك رؤية الصفقات المفتوحة من **📊 الصفقات المفتوحة**
- تحقق من التاريخ في **📈 تاريخ التداول**

### في السجلات (Logs)
يمكن للمطورين مراجعة السجلات لرؤية:
- الإشارات المستقبلة
- الأخطاء
- تفاصيل التنفيذ

## أمثلة متقدمة

### استراتيجية مع أهداف متعددة
```json
{
  "symbol": "BTCUSDT",
  "action": "BUY",
  "price": 50000,
  "tp_targets": [50750, 51500, 52500],
  "sl": 49000
}
```

### مع معلومات الاستراتيجية
```json
{
  "symbol": "{{ticker}}",
  "action": "{{strategy.order.action}}",
  "price": {{close}},
  "strategy": "{{strategy.name}}",
  "timeframe": "{{interval}}",
  "timestamp": "{{time}}"
}
```

## الدعم الفني

إذا واجهت أي مشاكل:
1. تحقق من الإعدادات
2. اختبر الرابط باستخدام cURL أو Postman
3. راجع السجلات
4. تواصل مع الدعم الفني

## الخلاصة

- ✅ كل مستخدم لديه رابط webhook فريد
- ✅ الإشارات تُعالج بشكل مستقل لكل مستخدم
- ✅ دعم كامل لـ TradingView والمنصات الأخرى
- ✅ آمن وموثوق
- ✅ سهل الاستخدام والإعداد

---

**ملاحظة**: تأكد من أن البوت يعمل وأنك قمت بتفعيل حسابك قبل إرسال الإشارات.

**تم التحديث**: 2024
**الإصدار**: 1.0.0

