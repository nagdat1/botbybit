# 🔄 تعليمات إعادة تشغيل البوت

## ⚠️ مهم جداً: يجب إعادة تشغيل البوت لتطبيق التحديثات!

---

## 📝 الخطوات:

### الطريقة 1️⃣: استخدام ملف Batch (الأسهل)
1. افتح المجلد: `C:\Users\nagda\OneDrive\المستندات\GitHub\botbybit`
2. انقر نقراً مزدوجاً على ملف: **`restart_bot.bat`**
3. ✅ تم! البوت يعمل الآن

---

### الطريقة 2️⃣: يدوياً
1. **إيقاف البوت الحالي:**
   - افتح Task Manager (Ctrl+Shift+Esc)
   - ابحث عن عملية `python.exe` 
   - انقر بزر الماوس الأيمن → End Task
   - كرر لجميع عمليات Python إذا كان هناك أكثر من واحدة

2. **تشغيل البوت:**
   - افتح Command Prompt أو PowerShell
   - اذهب للمجلد:
     ```bash
     cd "C:\Users\nagda\OneDrive\المستندات\GitHub\botbybit"
     ```
   - شغل البوت:
     ```bash
     python app.py
     ```

---

## ✅ التحديثات التي تم تطبيقها:

### 1. إصلاح مشكلة الاتصال مع Bybit API
- ✅ تم إزالة `timestamp` من query parameters
- ✅ يتم الآن إرساله فقط في headers

### 2. إضافة Logging تفصيلي
- ✅ تسجيل كامل لكل خطوة
- ✅ عرض الأخطاء بشكل واضح
- ✅ سهولة تتبع المشاكل

### 3. تحسين واجهة الربط
- ✅ **زر "🔗 ربط API Keys"** - للربط مباشرة
- ✅ **زر "✅ اختيار المنصة"** - يظهر فقط بعد الربط الناجح
- ✅ رسالة واضحة: "يجب ربط API أولاً" عند محاولة الاختيار بدون ربط

### 4. تحسين قاعدة البيانات
- ✅ فحص وجود المستخدم قبل التحديث
- ✅ رسائل خطأ تفصيلية
- ✅ معالجة أفضل للأخطاء

---

## 🧪 اختبار المفاتيح (اختياري)

إذا أردت اختبار مفاتيح API قبل إضافتها للبوت:

```bash
python test_bybit_connection.py
```

ثم أدخل:
- API Key: `RKk6fTapgDqys6vt5S`
- API Secret: `Rm1TEZnF8hJhZgoj2btSJCr7lx64qAP55dhp`

---

## 📱 استخدام البوت بعد إعادة التشغيل:

1. **افتح البوت في Telegram**
2. **اذهب إلى الإعدادات** (/settings)
3. **اختر "🏦 إدارة المنصات"**
4. **اختر "Bybit"**
5. **اضغط على "🔗 ربط API Keys"**
6. **أدخل المفاتيح:**
   - API Key: `RKk6fTapgDqys6vt5S`
   - API Secret: `Rm1TEZnF8hJhZgoj2btSJCr7lx64qAP55dhp`
7. **بعد الربط الناجح، اضغط "✅ اختيار هذه المنصة"**

---

## 🔍 مراقبة السجلات (Logs)

لمتابعة ما يحدث في البوت:
- افتح ملف: `trading_bot.log`
- ستجد كل التفاصيل: الاتصالات، الأخطاء، النجاحات

---

## ❓ حل المشاكل

### المشكلة: "فشل في حفظ البيانات"
**الحل:** 
- تأكد أن البوت متوقف تماماً
- احذف ملف `trading_bot.db`
- شغل البوت من جديد

### المشكلة: "فشل الاتصال"
**الحل:**
- تحقق من صحة المفاتيح
- تأكد من تفعيل API في حساب Bybit
- تأكد من الصلاحيات: Read, Trade (بدون Withdraw)

### المشكلة: الأزرار القديمة ما زالت تظهر
**الحل:**
- ⚠️ **يجب إعادة تشغيل البوت!**
- اتبع الطريقة 1 أو 2 أعلاه

---

## 📞 دعم

إذا واجهت أي مشكلة:
1. تحقق من `trading_bot.log`
2. أرسل آخر 50 سطر من السجل
3. اذكر الخطأ الذي يظهر في Telegram

---

✅ **تم إعداد كل شيء بنجاح!**

