# ๐ ููุงุญุธุงุช ุงูุชุญุฏูุซ - ูุธุงู Webhook ุงูุดุฎุตู

## โจ ุงูุชุญุฏูุซุงุช ุงูุฌุฏูุฏุฉ

ุชู ุชุญุฏูุซ ุงูุจูุช ููุฏุนู **ุฑูุงุจุท webhook ุดุฎุตูุฉ** ููู ูุณุชุฎุฏู ุจุงูุฅุถุงูุฉ ุฅูู ุงูุฑุงุจุท ุงููุฏูู.

---

## ๐ฏ ูุง ุชู ุฅุถุงูุชู

### 1. ุฏุนู ุงูุฑุงุจุท ุงููุฏูู โ
```
https://botbybit-production.up.railway.app/webhook
```
- ูุนูู ููุง ูุงู ุณุงุจููุง
- ูุณุชุฎุฏู ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ

### 2. ุฑูุงุจุท ุดุฎุตูุฉ ููู ูุณุชุฎุฏู โจ ุฌุฏูุฏ
```
https://botbybit-production.up.railway.app/personal/<user_id>/webhook
```
- ุฑุงุจุท ูุฑูุฏ ููู ูุณุชุฎุฏู
- ูุณุชุฎุฏู ุฅุนุฏุงุฏุงุช ุงููุณุชุฎุฏู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุตููุงุช ูููุตูุฉ ููู ูุณุชุฎุฏู

### 3. ูุนุงูุฌุฉ ุฐููุฉ ููุฅุดุงุฑุงุช ๐ง
- ุฏุนู ุฌููุน ุฃููุงุน ุงูุฅุดุงุฑุงุช: `buy`, `sell`, `long`, `short`, `close`, `exit`, `stop`
- ุงุณุชุฎุฑุงุฌ ุชููุงุฆู ูู `user_id` ูู ุงูุฑุงุจุท
- ุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ุงููุณุชุฎุฏู ุงูุฎุงุตุฉ (market_type, trade_amount, leverage)

### 4. Debug ูุญุณูู ๐
- ุฑุณุงุฆู ูุงุถุญุฉ ููู ุนูููุฉ
- ุชุชุจุน ุณูู ููุฅุดุงุฑุงุช
- ุนุฑุถ ุฅุนุฏุงุฏุงุช ุงููุณุชุฎุฏู ุนูุฏ ูู ุฅุดุงุฑุฉ

### 5. ุฃูุงู ูุญุณูู ๐
- ุงูุชุญูู ูู ูุฌูุฏ ุงููุณุชุฎุฏู
- ุงูุชุญูู ูู ุชูุนูู ุงููุณุชุฎุฏู
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### 1. `app.py`
- ุฅุถุงูุฉ route `/personal/<user_id>/webhook`
- ุฅุถุงูุฉ ุฏุงูุฉ `process_user_signal` ููุนุงูุฌุฉ ุฅุดุงุฑุงุช ุงููุณุชุฎุฏููู
- ุฅุถุงูุฉ ุฑุณุงุฆู debug ููุตูุฉ

### 2. `web_server.py`
- ุฅุถุงูุฉ route `/personal/<user_id>/webhook`
- ุฅุถุงูุฉ ุฏุงูุฉ `_process_user_signal` ุฏุงุฎู ุงูููุงุณ
- ุฏุนู WebSocket ููุฅุดุงุฑุงุช ุงูุดุฎุตูุฉ
- ุชุญุฏูุซ ุงูุฑุณูู ุงูุจูุงููุฉ ููู ูุณุชุฎุฏู

### 3. ูููุงุช ุฌุฏูุฏุฉ
- `WEBHOOK_GUIDE.md` - ุฏููู ุดุงูู ููุงุณุชุฎุฏุงู
- `test_webhooks.py` - ููู ุงุฎุชุจุงุฑ ุดุงูู
- `UPDATE_NOTES.md` - ูุฐุง ุงูููู

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุณุชุฎุฏู ุงููุงุญุฏ (ุงูุฑุงุจุท ุงููุฏูู):
```bash
curl -X POST https://botbybit-production.up.railway.app/webhook \
  -H "Content-Type: application/json" \
  -d '{"symbol": "BTCUSDT", "action": "buy", "price": 50000}'
```

### ูููุณุชุฎุฏููู ุงููุชุนุฏุฏูู (ุงูุฑุงุจุท ุงูุฌุฏูุฏ):
```bash
curl -X POST https://botbybit-production.up.railway.app/personal/123456789/webhook \
  -H "Content-Type: application/json" \
  -d '{"symbol": "ETHUSDT", "action": "buy", "price": 3000}'
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช:
```bash
python test_webhooks.py
```

### ูุจู ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช:
1. ุนุฏูู `BASE_URL` ูู `test_webhooks.py`
2. ุนุฏูู `TEST_USER_ID` ุฅูู user_id ุตุญูุญ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ุชุฃูุฏ ูู ุฃู ุงูุณูุฑูุฑ ูุนูู

---

## ๐ ุฑุณุงุฆู Debug

### ุนูุฏ ุงุณุชูุจุงู ุงูุฅุดุงุฑุฉ:
```
๐ [WEBHOOK ุดุฎุตู] ุงููุณุชุฎุฏู: 123456789
๐ [WEBHOOK ุดุฎุตู] ุงูุจูุงูุงุช ุงููุณุชููุฉ: {...}
โ [WEBHOOK ุดุฎุตู] ุงููุณุชุฎุฏู ููุฌูุฏ ููุดุท
๐ [WEBHOOK ุดุฎุตู] ุฅุนุฏุงุฏุงุช ุงููุณุชุฎุฏู: market_type=futures, account_type=demo
```

### ุนูุฏ ูุนุงูุฌุฉ ุงูุตููุฉ:
```
๐ [ูุนุงูุฌุฉ ุงูุฅุดุงุฑุฉ] ุจุฏุก ูุนุงูุฌุฉ ุฅุดุงุฑุฉ ุงููุณุชุฎุฏู 123456789
๐ [ูุนุงูุฌุฉ ุงูุฅุดุงุฑุฉ] ุงูุฑูุฒ: BTCUSDT, ุงูุฅุฌุฑุงุก: buy, ุงูุณุนุฑ: 50000
โ๏ธ [ูุนุงูุฌุฉ ุงูุฅุดุงุฑุฉ] ุงูุฅุนุฏุงุฏุงุช: market=futures, account=demo, amount=100, leverage=10
โ [ูุนุงูุฌุฉ ุงูุฅุดุงุฑุฉ] ูุฌุญ ูุชุญ ุงูุตููุฉ ูููุณุชุฎุฏู 123456789
```

---

## โ๏ธ ูุชุทูุจุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ูุฌุจ ุฃู ูููู ููู ูุณุชุฎุฏู:
- ุณุฌู ูู ุฌุฏูู `users` ูุน `is_active = 1`
- ุณุฌู ูู ุฌุฏูู `user_settings` ูุน ุงูุฅุนุฏุงุฏุงุช ุงููุทููุจุฉ

### ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ:
```python
from database import db_manager

db_manager.create_user(user_id=123456789)
db_manager.update_user_settings(
    user_id=123456789,
    settings={
        'market_type': 'futures',
        'trade_amount': 100.0,
        'leverage': 10,
        'account_type': 'demo'
    }
)
```

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ 404 - User not found:
- ุงููุณุชุฎุฏู ุบูุฑ ููุฌูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุฃูุดุฆ ุงููุณุชุฎุฏู ุฃููุงู

### ุฎุทุฃ 403 - User is not active:
- ุงููุณุชุฎุฏู ููุฌูุฏ ููู ุบูุฑ ููุนูู
- ูุนูู ุงููุณุชุฎุฏู: `db_manager.toggle_user_active(user_id)`

### ุฎุทุฃ 400 - No data received:
- ุชุญูู ูู ุตูุบุฉ JSON ุงููุฑุณูุฉ
- ุชุฃูุฏ ูู ูุฌูุฏ `symbol` ู `action`

---

## ๐ ุงููุซุงุฆู ุงููุงููุฉ

ุฑุงุฌุน `WEBHOOK_GUIDE.md` ููุญุตูู ุนูู:
- ุดุฑุญ ููุตู ููู ููุฒุฉ
- ุฃูุซูุฉ ุงุณุชุฎุฏุงู ูู TradingView
- ุฏููู ุงุณุชูุดุงู ุงูุฃุฎุทุงุก ุงููุงูู
- ุฃูุซูุฉ ูุชูุฏูุฉ

---

## โ ุงูุชูุงูู

- โ ูุชูุงูู ูุน ุงูุฑุงุจุท ุงููุฏูู
- โ ูุง ูุชุทูุจ ุชุนุฏูู ูู TradingView ูููุณุชุฎุฏู ุงููุฏูู
- โ ูุฏุนู ุงููุณุชุฎุฏููู ุงูุฌุฏุฏ ุจุฑูุงุจุท ุดุฎุตูุฉ
- โ ูุนุงูุฌุฉ ูุชุฒุงููุฉ ููุฅุดุงุฑุงุช
- โ ุฏุนู ุฌููุน ุฃููุงุน ุงูุฅุดุงุฑุงุช

---

## ๐ ุงูุฎูุงุตุฉ

ุงูุขู ุงูุจูุช ูุฏุนู:
1. โ ุงูุฑุงุจุท ุงููุฏูู `/webhook` (ูุนูู ููุง ูุงู)
2. โ ุฑูุงุจุท ุดุฎุตูุฉ `/personal/<user_id>/webhook` (ุฌุฏูุฏ)
3. โ ูุนุงูุฌุฉ ุฐููุฉ ุจุงุณุชุฎุฏุงู ุฅุนุฏุงุฏุงุช ูู ูุณุชุฎุฏู
4. โ Debug ูุชูุฏู ูุน ุฑุณุงุฆู ูุงุถุญุฉ
5. โ ุฃูุงู ูุญุณูู ูุน ุงูุชุญูู ูู ุงููุณุชุฎุฏููู
6. โ ุฏุนู ุฌููุน ุฃููุงุน ุงูุฅุดุงุฑุงุช
7. โ ุฅุดุนุงุฑุงุช Telegram ุดุฎุตูุฉ ููู ูุณุชุฎุฏู

**ุฌุงูุฒ ููุงุณุชุฎุฏุงู! ๐**

---

## ๐ ูููุฒูุฏ ูู ุงููุนูููุงุช

- ุฑุงุฌุน `WEBHOOK_GUIDE.md` ููุฏููู ุงููุงูู
- ุฑุงุฌุน `test_webhooks.py` ูุฃูุซูุฉ ุงูุงุฎุชุจุงุฑ
- ุชุญูู ูู logs ุงูุณูุฑูุฑ ูุชุชุจุน ุงูุนูููุงุช

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 2025-10-07  
**ุงูุฅุตุฏุงุฑ:** 2.0.0 - Personal Webhooks

