# ุฅุตูุงุญุงุช ุงุชุตุงู API ููููุตุงุช

## ๐ ุงูููุฎุต

ุชู ุฅุตูุงุญ ูุดุงูู ุงูุชุญูู ูู API ูู ุจูุช ุงูุชุฏุงูู ูุถูุงู ุธููุฑ ุฑุณุงุฆู ูุงุถุญุฉ ููููููุฉ ุนูุฏ ุฑุจุท ุงูููุตุงุช (Bybit ู MEXC) ูุน ุงูุจูุช ุนุจุฑ ุงูุชูุฌุฑุงู.

## ๐ง ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1. ุชุญุณูู ุฑุณุงุฆู ุงูุชุญูู (ุฌุงุฑู ุงูุชุญูู...)

#### ูุจู ุงูุฅุตูุงุญ:
- ุฑุณุงูุฉ ุจุณูุทุฉ "๐ ุฌุงุฑู ุงูุชุญูู ูู ุตุญุฉ API keys... โก ุงุฎุชุจุงุฑ ุณุฑูุน..."
- ูุฏ ุชุณุชูุฑ ุทูููุงู ุฏูู ุชุญุฏูุซ
- ูุง ุชูุถุญ ุงูููุตุฉ ุงููุณุชุฎุฏูุฉ

#### ุจุนุฏ ุงูุฅุตูุงุญ:
```
๐ ุฌุงุฑู ุงูุชุญูู ูู Bybit API...

๐ฆ ุงูุงุชุตุงู ุจุงูููุตุฉ...
โณ ูุฑุฌู ุงูุงูุชุธุงุฑ (3-5 ุซูุงูู)
```

### 2. ุชุญุณูู ุฑุณุงุฆู ุงููุฌุงุญ

#### ูุจู ุงูุฅุตูุงุญ:
```
โ ุชู ุฑุจุท API ุจูุฌุงุญ!

๐ฆ ุงูููุตุฉ: Bybit
๐ข ุงูุงุชุตุงู: https://api.bybit.com (Live)
```

#### ุจุนุฏ ุงูุฅุตูุงุญ:
```
โ ุชู ุงูุฑุจุท ุจูุฌุงุญ!

๐ฆ ุงูููุตุฉ: Bybit
๐ข ุงูุญุงูุฉ: ูุชุตู ููุนูู
๐ API: api.bybit.com
๐ ุงูุชุฏุงูู: Spot & Futures
๐ ุงูุฃูุงู: ูุดูุฑ โ

โโโโโโโโโโโโโโโโโโโโ
๐ ููููู ุงูุขู:
โข ุงุณุชูุจุงู ูุชูููุฐ ุฅุดุงุฑุงุช ุงูุชุฏุงูู
โข ุฅุฏุงุฑุฉ ุงูุตููุงุช ุงูููุชูุญุฉ
โข ูุชุงุจุนุฉ ุงูุฃุฑุจุงุญ ูุงูุฎุณุงุฆุฑ
โข ุงุณุชุฎุฏุงู ุฌููุน ุฃุฏูุงุช ุงูุจูุช

ุงุณุชุฎุฏู /start ููุจุฏุก!
```

### 3. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

#### ุฃ. ูุนุงูุฌุฉ Timeout:
```python
# ูุจู
except asyncio.TimeoutError:
    return False

# ุจุนุฏ
except asyncio.TimeoutError:
    await checking_message.delete()
    await update.message.reply_text(
        f"โฑ๏ธ ุงูุชูุช ูููุฉ ุงูุชุญูู ูู {platform_name}!
        
        ๐ ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:
        โข ุณูุฑูุฑ ุงูููุตุฉ ุจุทูุก ุญุงููุงู
        โข ูุดููุฉ ูุคูุชุฉ ูู ุงูุงุชุตุงู
        โข IP ูุญุธูุฑ ุฃู ูููุฏ
        
        ๐ก ุงูุญู:
        โข ุญุงูู ูุฑุฉ ุฃุฎุฑู ุจุนุฏ 30 ุซุงููุฉ
        โข ุชุฃูุฏ ูู ุงุชุตุงูู ุจุงูุฅูุชุฑูุช
        โข ุชุญูู ูู ุฅุนุฏุงุฏุงุช IP Whitelist"
    )
```

#### ุจ. ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูุดุจูุฉ:
```python
# ูู check_api_connection()
except requests.exceptions.Timeout:
    logger.error("โฑ๏ธ ุงูุชูุช ูููุฉ ุงูุงุชุตุงู")
    return False
except requests.exceptions.ConnectionError:
    logger.error("๐ ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุดุจูุฉ")
    return False
```

### 4. ุชุญุณูู ุงูุฃุฏุงุก

#### ุชูููู Timeout:
```python
# Bybit API
timeout = 5 if endpoint == "/v5/account/wallet-balance" else 10

# MEXC API - test_connection
timeout = 3  # ูู 5 ุซูุงูู
recvWindow = 3000  # ูู 5000

# asyncio.wait_for
timeout = 8.0  # ูู 10 ุซูุงูู
```

### 5. ุชุญุณูู Logging

#### ูุจู:
```python
logger.info(f"ุงุณุชุฌุงุจุฉ API: {account_info}")
```

#### ุจุนุฏ:
```python
logger.info(f"๐ก Bybit: ุฅุฑุณุงู ุทูุจ {method} ุฅูู: {url}")
logger.info(f"๐ฅ Bybit: ุฑูุฒ ุงูุงุณุชุฌุงุจุฉ: {response.status_code}")
logger.debug(f"๐ Bybit: ุงุณุชุฌุงุจุฉ API: {result}")
```

## ๐งช ููู ุงูุงุฎุชุจุงุฑ ุงูุฌุฏูุฏ

ุชู ุฅูุดุงุก ููู `test_api_connection.py` ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจุณูููุฉ:

```bash
python test_api_connection.py
```

### ุงูููุฒุงุช:
- โ ุงุฎุชุจุงุฑ Bybit API
- โ ุงุฎุชุจุงุฑ MEXC API
- โ ุงุฎุชุจุงุฑ ููุง ุงูููุตุชูู
- โ ุฑุณุงุฆู ูุงุถุญุฉ ูููุตูุฉ
- โ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก

## ๐ ุงูุชุฏูู ุงูุฌุฏูุฏ ููุชุญูู

```
1. ุงููุณุชุฎุฏู ูุฏุฎู API_KEY
   โ
2. ุงููุณุชุฎุฏู ูุฏุฎู API_SECRET
   โ
3. ุนุฑุถ: "๐ ุฌุงุฑู ุงูุชุญูู ูู [ุงูููุตุฉ] API..."
   โ
4. ุงุณุชุฏุนุงุก check_api_connection() (ูุน timeout 8 ุซูุงูู)
   โ
5. ุฅุฐุง ูุฌุญ:
   - ุนุฑุถ: "โ ุชู ุงูุชุญูู ุจูุฌุงุญ!"
   - ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ููุตูุฉ
   โ
6. ุฅุฐุง ูุดู:
   - ุญุฐู ุฑุณุงูุฉ ุงูุชุญูู
   - ุนุฑุถ ุฑุณุงูุฉ ุฎุทุฃ ููุตูุฉ ูุน ุงูุญููู
```

## ๐ ุงูุชุญุณููุงุช ูู ุงูููุฏ

### BybitAPI._make_request():
```python
# ุชุญุณูู ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุกุงุช
except requests.exceptions.Timeout:
    return {"retCode": -1, "retMsg": "ุงูุชูุช ูููุฉ ุงูุงุชุตุงู ุจุงูุณูุฑูุฑ"}
except requests.exceptions.ConnectionError as e:
    return {"retCode": -1, "retMsg": "ูุดู ุงูุงุชุตุงู ุจุณูุฑูุฑ Bybit"}
except requests.exceptions.HTTPError as e:
    return {"retCode": -1, "retMsg": f"ุฎุทุฃ HTTP: {e.response.status_code}"}
```

### MEXCAPI.test_connection():
```python
# ุฅุถุงูุฉ ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
except requests.exceptions.Timeout:
    return {"success": False, "code": -1, "msg": "ุงูุชูุช ูููุฉ ุงูุงุชุตุงู"}
except requests.exceptions.ConnectionError as e:
    return {"success": False, "code": -1, "msg": "ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุดุจูุฉ"}
```

### check_api_connection():
```python
# ุฅุถุงูุฉ try-except ููู ููุตุฉ
if platform == 'mexc':
    try:
        temp_api = MEXCAPI(api_key, api_secret)
        test_result = temp_api.test_connection()
        # ... ูุนุงูุฌุฉ ุงููุชูุฌุฉ
    except requests.exceptions.Timeout:
        logger.error("โฑ๏ธ MEXC: ุงูุชูุช ูููุฉ ุงูุงุชุตุงู")
        return False
    except requests.exceptions.ConnectionError:
        logger.error("๐ MEXC: ุฎุทุฃ ูู ุงูุงุชุตุงู ุจุงูุดุจูุฉ")
        return False
```

## ๐ ุงูุชูุตูุงุช

### ูููุณุชุฎุฏููู:
1. โ ุชุฃูุฏ ูู ุตุญุฉ API Keys ูุจู ุงูุฅุฏุฎุงู
2. โ ุชุญูู ูู ุตูุงุญูุงุช API (Read + Trading)
3. โ ุชุฃูุฏ ูู ุนุฏู ุชูุนูู IP Whitelist (ุฃู ุฃุถู IP ุงูุณูุฑูุฑ)
4. โ ุงูุชุธุฑ 3-8 ุซูุงูู ููุชุญูู
5. โ ุฅุฐุง ูุดู ุงูุชุญููุ ุงุชุจุน ุงูุญููู ุงูููุชุฑุญุฉ ูู ุฑุณุงูุฉ ุงูุฎุทุฃ

### ูููุทูุฑูู:
1. โ ุงุณุชุฎุฏู `test_api_connection.py` ูุงุฎุชุจุงุฑ API ูุจู ุงูุชุทุจูู
2. โ ุชุญูู ูู logs ูู `trading_bot.log` ูููุฒูุฏ ูู ุงูุชูุงุตูู
3. โ ุงุณุชุฎุฏู `test_mexc_api.py` ูุงุฎุชุจุงุฑ MEXC ุจุดูู ูููุตู
4. โ ุฑุงูุจ timeout values ุฅุฐุง ูุงูุช ุงูุดุจูุฉ ุจุทูุฆุฉ

## ๐ฏ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### ุงูุณููุงุฑูู 1: API ุตุญูุญ
- โฑ๏ธ ุงูููุช: 3-5 ุซูุงูู
- โ ุฑุณุงูุฉ: "ุชู ุงูุฑุจุท ุจูุฌุงุญ!"
- ๐ข ุงูุญุงูุฉ: ูุชุตู ููุนูู

### ุงูุณููุงุฑูู 2: API ุฎุงุทุฆ
- โฑ๏ธ ุงูููุช: 3-5 ุซูุงูู
- โ ุฑุณุงูุฉ: "ูุดู ุงูุชุญูู ูู API Keys!"
- ๐ ุงูุญููู: ููุชุฑุญุฉ ูู ุงูุฑุณุงูุฉ

### ุงูุณููุงุฑูู 3: Timeout
- โฑ๏ธ ุงูููุช: 8 ุซูุงูู
- โฑ๏ธ ุฑุณุงูุฉ: "ุงูุชูุช ูููุฉ ุงูุชุญูู!"
- ๐ก ุงูุญููู: ุญุงูู ูุฑุฉ ุฃุฎุฑูุ ุชุญูู ูู ุงูุงุชุตุงู

## ๐ ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

### ุงููุดููุฉ: "ุฌุงุฑู ุงูุชุญูู..." ูุง ุชุชููู
**ุงูุญู:** ุชู ุฅุตูุงุญู! ุงูุขู timeout ูุญุฏุฏ ุจู 8 ุซูุงูู

### ุงููุดููุฉ: ูุง ุชูุฌุฏ ุฑุณุงูุฉ ุจุนุฏ ุฅุฏุฎุงู API_SECRET
**ุงูุญู:** ุชู ุฅุตูุงุญู! ุงูุขู ูุชู ุนุฑุถ "โ ุชู ุงูุชุญูู ุจูุฌุงุญ!" ุซู ุฑุณุงูุฉ ุงููุฌุงุญ

### ุงููุดููุฉ: ุฑุณุงูุฉ ุฎุทุฃ ุบูุฑ ูุงุถุญุฉ
**ุงูุญู:** ุชู ุฅุตูุงุญู! ุงูุขู ุฑุณุงุฆู ุงูุฎุทุฃ ููุตูุฉ ูุน ุงูุญููู ุงูููุชุฑุญุฉ

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:
1. ุชุญูู ูู ููู `trading_bot.log`
2. ุงุณุชุฎุฏู `test_api_connection.py` ููุงุฎุชุจุงุฑ
3. ุชุฃูุฏ ูู ุตุญุฉ API Keys ูู ููุญุฉ ุชุญูู ุงูููุตุฉ
4. ุชุญูู ูู ุตูุงุญูุงุช API
5. ุฑุงุฌุน ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูููุตูุฉ ูู ุงูุชูุฌุฑุงู

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-11  
**ุงูุฅุตุฏุงุฑ:** 2.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ

