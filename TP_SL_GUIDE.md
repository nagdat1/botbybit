# ุฏููู ูุธุงู Take Profit ู Stop Loss ุงููุชูุฏู

## ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ูุธุงู ูุชูุฏู ูุฅุฏุงุฑุฉ Take Profit (TP) ู Stop Loss (SL) ุงููุชุนุฏุฏ ูุน ุฏุนู ุงูุฅุบูุงูุงุช ุงูุฌุฒุฆูุฉ ุฅูู ุจูุช ุงูุชุฏุงูู ุนูู Bybit.

## ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. Take Profit ุงููุชุนุฏุฏ
- ุฅููุงููุฉ ุฅุถุงูุฉ ุนุฏุฉ ูุณุชููุงุช Take Profit ููู ุตููุฉ (TP1, TP2, TP3, ...)
- ุชุญุฏูุฏ ุงูุณุนุฑ ุงููุณุชูุฏู ุจุทุฑููุชูู:
  - **ูุณุจุฉ ูุฆููุฉ**: ูุซู +5% ูู ุณุนุฑ ุงูุฏุฎูู
  - **ุณุนุฑ ูุญุฏุฏ**: ูุซู 50000 USDT
- ุชุญุฏูุฏ ูุณุจุฉ ุงูุฅุบูุงู ููู ูุณุชูู (25%, 50%, 75%, 100%)

### 2. Stop Loss ุงูุฐูู
- ุชุญุฏูุฏ Stop Loss ุจุทุฑููุชูู:
  - **ูุณุจุฉ ูุฆููุฉ**: ูุซู -2% ูู ุณุนุฑ ุงูุฏุฎูู
  - **ุณุนุฑ ูุญุฏุฏ**: ูุซู 48000 USDT
- ุฏุนู **Trailing Stop** (ููุฏ ุงูุชุทููุฑ ุงููุณุชูุจูู)
- ุชุญุฏูุซ ุชููุงุฆู ููู SL ุญุณุจ ุญุฑูุฉ ุงูุณุนุฑ

### 3. ุงูุฅุบูุงูุงุช ุงูุฌุฒุฆูุฉ
- ุฅููุงููุฉ ุฅุบูุงู ุฌุฒุก ูู ุงูุตููุฉ ุนูุฏ ูู ูุณุชูู TP
- ุชุชุจุน ุงููููุฉ ุงููุชุจููุฉ ูู ุงูุตููุฉ
- ุญุณุงุจ ุฏููู ููุฃุฑุจุงุญ/ุงูุฎุณุงุฆุฑ ููู ุฅุบูุงู ุฌุฒุฆู

### 4. ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
- ูุธุงู ูุฑุงูุจุฉ ูุณุชูุฑ ููุฃุณุนุงุฑ (ูู 10 ุซูุงูู)
- ุชูุนูู ุชููุงุฆู ูู TP/SL ุนูุฏ ุงููุตูู ููุณุนุฑ ุงููุณุชูุฏู
- ุฅุดุนุงุฑุงุช ููุฑูุฉ ุนูุฏ ุงูุชูููุฐ

## ุจููุฉ ุงููููุงุช

```
botbybit/
โโโ order_manager.py         # ุฅุฏุงุฑุฉ ุงูุตููุงุช ูTP/SL
โโโ trade_interface.py       # ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุชูุงุนููุฉ
โโโ bot_integration.py       # ุฑุจุท ุงููุธุงู ูุน ุงูุจูุช
โโโ database.py              # ูุงุนุฏุฉ ุงูุจูุงูุงุช (ูุญุฏูุซุฉ)
โโโ bybit_trading_bot.py     # ุงูุจูุช ุงูุฑุฆูุณู (ุณูุชู ุชุญุฏูุซู)
```

## ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ูุชุญ ุตููุฉ ุฌุฏูุฏุฉ ูุน TP/SL

#### ุงูุฎุทูุฉ 1: ูุชุญ ุงูุตููุฉ
ุนูุฏ ูุชุญ ุตููุฉ ุฌุฏูุฏุฉุ ุณูุธูุฑ ูู ูุงุฆูุฉ ุฎูุงุฑุงุช:
```
๐ ุฅุนุฏุงุฏ ุตููุฉ ุฌุฏูุฏุฉ
๐ธ ุงูุฑูุฒ: BTCUSDT
๐ธ ุงูููุน: BUY
๐ธ ุงูุณุนุฑ: 50000.000000
๐ธ ุงููููุฉ: 0.1

[๐ ุฅุถุงูุฉ Take Profit]
[๐ก๏ธ ุฅุถุงูุฉ Stop Loss]
[โ ูุชุญ ุงูุตููุฉ ุงูุขู]
[โ ุฅูุบุงุก]
```

#### ุงูุฎุทูุฉ 2: ุฅุถุงูุฉ Take Profit
1. ุงุถุบุท ุนูู "๐ ุฅุถุงูุฉ Take Profit"
2. ุงุฎุชุฑ ุทุฑููุฉ ุชุญุฏูุฏ ุงูุณุนุฑ:
   - **ูุณุจุฉ ูุฆููุฉ (%)**: ูุซู 5 (ูุนูู +5%)
   - **ุณุนุฑ ูุญุฏุฏ**: ูุซู 52500
3. ุฃุฏุฎู ุงููููุฉ
4. ุงุฎุชุฑ ูุณุจุฉ ุงูุฅุบูุงู:
   - 25% - 50% - 75% - 100%
5. ููููู ุฅุถุงูุฉ ุนุฏุฉ ูุณุชููุงุช TP

#### ุงูุฎุทูุฉ 3: ุฅุถุงูุฉ Stop Loss
1. ุงุถุบุท ุนูู "๐ก๏ธ ุฅุถุงูุฉ Stop Loss"
2. ุงุฎุชุฑ ุทุฑููุฉ ุชุญุฏูุฏ ุงูุณุนุฑ:
   - **ูุณุจุฉ ูุฆููุฉ (%)**: ูุซู 2 (ูุนูู -2%)
   - **ุณุนุฑ ูุญุฏุฏ**: ูุซู 49000
3. ุฃุฏุฎู ุงููููุฉ

#### ุงูุฎุทูุฉ 4: ุชุฃููุฏ ุงูุตููุฉ
ุงุถุบุท ุนูู "โ ูุชุญ ุงูุตููุฉ ุงูุขู" ูุชุฃููุฏ ููุชุญ ุงูุตููุฉ ูุน TP/SL

### 2. ุฅุฏุงุฑุฉ ุงูุตููุงุช ุงูููุชูุญุฉ

ุนูุฏ ุนุฑุถ ุงูุตููุงุช ุงูููุชูุญุฉุ ุณุชุธูุฑ ุชูุงุตูู TP/SL:
```
๐ ุชูุงุตูู ุงูุตููุฉ

๐ธ ุงูุฑูุฒ: BTCUSDT
๐ธ ุงูููุน: BUY
๐ธ ุณุนุฑ ุงูุฏุฎูู: 50000.000000
๐ธ ุงูุณุนุฑ ุงูุญุงูู: 51000.000000
๐ธ PnL ุบูุฑ ูุญูู: +100.00

๐ Take Profit Levels:
โณ TP1: 51250.000000 (50%)
โณ TP2: 52500.000000 (50%)

๐ก๏ธ Stop Loss:
โณ SL: 49000.000000

[๐ ุฅุถุงูุฉ TP]
[๐ก๏ธ ุชุนุฏูู SL]
[๐ ุฅุบูุงู ุฌุฒุฆู]
[โ ุฅุบูุงู ูุงูู]
[๐ ุชุญุฏูุซ]
[๐ ุงูุนูุฏุฉ]
```

### 3. ุงูุชูุงุนู ูุน TP/SL

#### ุนูุฏ ุชูุนูู Take Profit:
```
โ Take Profit 1 ูููุนูู!

๐ ุงูุตููุฉ: BTCUSDT
๐ฒ ุณุนุฑ ุงูุฏุฎูู: 50000.000000
๐ฒ ุณุนุฑ ุงูุชูููุฐ: 51250.000000
๐ฐ ุงููููุฉ ุงูููุบููุฉ: 0.05 (50%)
๐ข PnL: +62.50

ุงููููุฉ ุงููุชุจููุฉ: 0.05
```

#### ุนูุฏ ุชูุนูู Stop Loss:
```
โ๏ธ Stop Loss ูููุนูู!

๐ ุงูุตููุฉ: BTCUSDT
๐ฒ ุณุนุฑ ุงูุฏุฎูู: 50000.000000
๐ฒ ุณุนุฑ ุงูุชูููุฐ: 49000.000000
๐ฐ ุงููููุฉ: 0.1
๐ด PnL: -100.00

ุชู ุฅุบูุงู ุงูุตููุฉ ุจุงููุงูู.
```

## ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุงุณุชุฑุงุชูุฌูุฉ Conservative
```
ุตููุฉ: ุดุฑุงุก BTC ุนูุฏ 50000$
ุงููููุฉ: 0.1 BTC

TP1: +2% (50% ูู ุงูุตููุฉ) = 51000$
TP2: +5% (50% ูู ุงูุตููุฉ) = 52500$
SL: -2% = 49000$

ุงููุชูุฌุฉ ุงููุญุชููุฉ:
- ุนูุฏ TP1: ุฅุบูุงู 0.05 BTC ุจุฑุจุญ +50$
- ุนูุฏ TP2: ุฅุบูุงู 0.05 BTC ุจุฑุจุญ +125$
- ุฅุฌูุงูู ุงูุฑุจุญ: +175$
```

### ูุซุงู 2: ุงุณุชุฑุงุชูุฌูุฉ Aggressive
```
ุตููุฉ: ุดุฑุงุก ETH ุนูุฏ 3000$
ุงููููุฉ: 1 ETH

TP1: +5% (25%) = 3150$
TP2: +10% (25%) = 3300$
TP3: +15% (50%) = 3450$
SL: -3% = 2910$

ุงููุชูุฌุฉ ุงููุญุชููุฉ:
- ุนูุฏ TP1: ุฅุบูุงู 0.25 ETH ุจุฑุจุญ +37.5$
- ุนูุฏ TP2: ุฅุบูุงู 0.25 ETH ุจุฑุจุญ +75$
- ุนูุฏ TP3: ุฅุบูุงู 0.5 ETH ุจุฑุจุญ +225$
- ุฅุฌูุงูู ุงูุฑุจุญ: +337.5$
```

### ูุซุงู 3: Futures ูุน ุฑุงูุนุฉ ูุงููุฉ
```
ุตููุฉ: ุดุฑุงุก BTC Futures ุนูุฏ 50000$
ุงููุงูุด: 1000$
ุงูุฑุงูุนุฉ: 10x
ุญุฌู ุงูุตููุฉ: 10000$

TP1: +2% (50%) = 51000$ โ ุฑุจุญ +100$
TP2: +4% (50%) = 52000$ โ ุฑุจุญ +200$
SL: -5% = 47500$ โ ุฎุณุงุฑุฉ -250$
```

## ุงูุฑุจุท ูุน ุงูุจูุช ุงูุญุงูู

ูุชูุนูู ุงููุธุงู ูู ุงูุจูุช ุงูุญุงููุ ุฃุถู ุงูุฃุณุทุฑ ุงูุชุงููุฉ ูู `bybit_trading_bot.py`:

```python
# ูู ุจุฏุงูุฉ ุงูููู
from order_manager import order_manager, PriceType
from trade_interface import trade_interface
from bot_integration import bot_integration

# ูู ุฏุงูุฉ main() ุจุนุฏ ุฅุนุฏุงุฏ application
# ุจุฏุก ูุธุงู ูุฑุงูุจุฉ ุงูุฃุณุนุงุฑ
async def start_monitoring():
    await bot_integration.load_managed_orders_from_db()
    await bot_integration.start_price_monitoring(trading_bot.bybit_api)

# ุฅุถุงูุฉ ุฅูู application
application.post_init = start_monitoring

# ูู ูุนุงูุฌ ุงูุฃุฒุฑุงุฑ (handle_callback)
# ุฅุถุงูุฉ ูุนุงูุฌุงุช ูุฃุฒุฑุงุฑ TP/SL
if data.startswith("trade_"):
    # ูุนุงูุฌุฉ ุฃุฒุฑุงุฑ ูุงุฌูุฉ ุงูุชุฏุงูู
    await handle_trade_interface(update, context, data)
```

## ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏุงูู ุฌุฏูุฏุฉ:

#### 1. `take_profit_levels`
- id (PRIMARY KEY)
- order_id (FOREIGN KEY)
- level_number
- price_type ('percentage' ุฃู 'price')
- value
- close_percentage
- target_price
- executed
- executed_time
- executed_price
- pnl

#### 2. `stop_losses`
- id (PRIMARY KEY)
- order_id (FOREIGN KEY)
- price_type ('percentage' ุฃู 'price')
- value
- target_price
- trailing
- trailing_distance
- trailing_activated_price
- executed
- executed_time
- executed_price
- pnl

#### 3. `partial_closes`
- id (PRIMARY KEY)
- order_id (FOREIGN KEY)
- close_type ('TAKE_PROFIT' ุฃู 'STOP_LOSS' ุฃู 'MANUAL')
- level
- price
- quantity
- percentage
- pnl
- close_time

## ุงุณุชุฑุงุชูุฌูุงุช TP/SL ุงูููุตู ุจูุง

### 1. Fixed Ratio (1:2)
```
Risk: 2%
Reward: 4%
Example: Entry 50000, SL 49000 (-2%), TP 52000 (+4%)
```

### 2. Scaled Take Profit
```
TP1: +2% (33%)
TP2: +5% (33%)
TP3: +10% (34%)
SL: -2%
```

### 3. Break-even Strategy
```
TP1: +2% (50%) โ ุฑูุน SL ุฅูู ููุทุฉ ุงูุฏุฎูู
TP2: +5% (50%)
SL: -2% (ูุตุจุญ 0% ุจุนุฏ TP1)
```

### 4. Trailing Stop
```
Entry: 50000
Initial SL: 49000 (-2%)
Trailing Distance: 1%

ุฅุฐุง ูุตู ุงูุณุนุฑ ุฅูู 51000:
New SL: 50490 (-1% ูู ุงูุณุนุฑ ุงูุญุงูู)
```

## ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ูุญููููุง

### 1. "ุงูุตููุฉ ุบูุฑ ููุฌูุฏุฉ"
**ุงูุญู**: ุชุฃูุฏ ูู ูุชุญ ุงูุตููุฉ ุฃููุงู ูุจู ุฅุถุงูุฉ TP/SL

### 2. "ูุดู ูู ุญุณุงุจ ุงูุณุนุฑ ุงููุณุชูุฏู"
**ุงูุญู**: ุชุฃูุฏ ูู ุฅุฏุฎุงู ูููุฉ ุตุญูุญุฉ (ุฑูู ููุฌุจ)

### 3. "ูุณุจุฉ ุงูุฅุบูุงู ุบูุฑ ุตุญูุญุฉ"
**ุงูุญู**: ูุฌุจ ุฃู ุชููู ุงููุณุจุฉ ุจูู 0 ู 100

### 4. "TP/SL ูู ูุชู ุชูุนููู"
**ุงูุญู**: 
- ุชุฃูุฏ ูู ุฃู ูุธุงู ุงููุฑุงูุจุฉ ูุดุท
- ุชุญูู ูู ุฃู ุงูุณุนุฑ ุงููุณุชูุฏู ุตุญูุญ
- ุฑุงุฌุน logs ุงูุจูุช ููุฃุฎุทุงุก

## ุงูุชุทููุฑุงุช ุงููุณุชูุจููุฉ

- [ ] ุฏุนู Trailing Stop ุจุงููุงูู
- [ ] ูุงุฌูุฉ ููุจ ูุฅุฏุงุฑุฉ TP/SL
- [ ] ุชุญูููุงุช ูุชูุฏูุฉ ููุฃุฏุงุก
- [ ] ุฅุดุงุฑุงุช ุฐููุฉ ูุงูุชุฑุงุญ TP/SL
- [ ] ุฏุนู OCO (One-Cancels-Other)
- [ ] Break-even ุชููุงุฆู

## ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุฅุจูุงุบ ุนู ูุดุงูู:
- ุฑุงุฌุน logs ุงูุจูุช ูู `trading_bot.log`
- ุงูุชุญ issue ุนูู GitHub
- ุงุณุชุฎุฏู ุฃูุฑ `/start` ููุนูุฏุฉ ุฅูู ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ

## ุงูุฎูุงุตุฉ

ูุธุงู TP/SL ุงููุชูุฏู ูููุฑ:
- โ ุฅุฏุงุฑุฉ ุงุญุชุฑุงููุฉ ูููุฎุงุทุฑ
- โ ุชูููุฐ ุชููุงุฆู ุฏููู
- โ ูุฑููุฉ ูู ุงูุชุฎุตูุต
- โ ุชุชุจุน ุดุงูู ููุฃุฏุงุก
- โ ุฏุนู ูุงูู ูู Spot ู Futures

ุงุณุชูุชุน ุจุชุฏุงูู ุขูู ูุงุญุชุฑุงูู! ๐

