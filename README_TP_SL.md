# ูุธุงู Take Profit ู Stop Loss ุงููุชูุฏู - ููุฎุต ุณุฑูุน

## โจ ูุง ุชู ุฅูุฌุงุฒู

ุชู ุฅูุดุงุก ูุธุงู ูุชูุฏู ูุดุงูู ูุฅุฏุงุฑุฉ Take Profit ู Stop Loss ูุน ุงูุฅุบูุงูุงุช ุงูุฌุฒุฆูุฉ ููุตููุงุช ูู ุจูุช ุงูุชุฏุงูู ุนูู Bybit.

## ๐ฆ ุงููููุงุช ุงูุฌุฏูุฏุฉ

| ุงูููู | ุงููุตู |
|-------|-------|
| `order_manager.py` | ุงููุธุงู ุงูุฃุณุงุณู ูุฅุฏุงุฑุฉ ุงูุตููุงุช ูุน TP/SL |
| `trade_interface.py` | ุงููุงุฌูุฉ ุงูุชูุงุนููุฉ ูููุณุชุฎุฏููู |
| `bot_integration.py` | ุฑุจุท ุงููุธุงู ูุน ุงูุจูุช ุงูุญุงูู |
| `TP_SL_GUIDE.md` | ุฏููู ุดุงูู ููุงุณุชุฎุฏุงู |
| `examples_tpsl.py` | ุฃูุซูุฉ ุนูููุฉ |
| `README_TP_SL.md` | ูุฐุง ุงูููู |

## ๐ ุงููููุงุช ุงููุญุฏุซุฉ

- โ `database.py` - ุฅุถุงูุฉ ุฌุฏุงูู TP/SL ูุงูุฅุบูุงูุงุช ุงูุฌุฒุฆูุฉ
- โณ `bybit_trading_bot.py` - ูุญุชุงุฌ ููุฑุจุท (ุงูุธุฑ ุงูุชุนูููุงุช ุฃุฏูุงู)

## ๐ ุงููููุฒุงุช

### 1. Take Profit ุงููุชุนุฏุฏ
- โ ุฅุถุงูุฉ ุนุฏุฉ ูุณุชููุงุช TP (TP1, TP2, TP3, ...)
- โ ุชุญุฏูุฏ ุจูุณุจุฉ ูุฆููุฉ ุฃู ุณุนุฑ ูุญุฏุฏ
- โ ุฅุบูุงู ุฌุฒุฆู ูุฎุตุต ููู ูุณุชูู

### 2. Stop Loss ุงูุฐูู
- โ ุชุญุฏูุฏ ุจูุณุจุฉ ูุฆููุฉ ุฃู ุณุนุฑ ูุญุฏุฏ
- โ ุฏุนู Trailing Stop (ุฌุงูุฒ ููุชูุนูู)
- โ ุญูุงูุฉ ุชููุงุฆูุฉ ูู ุงูุฎุณุงุฆุฑ

### 3. ุงููุฑุงูุจุฉ ุงูุชููุงุฆูุฉ
- โ ูุฑุงูุจุฉ ูุณุชูุฑุฉ ููุฃุณุนุงุฑ (ูู 10 ุซูุงูู)
- โ ุชูุนูู ุชููุงุฆู ูู TP/SL
- โ ุฅุดุนุงุฑุงุช ููุฑูุฉ

### 4. ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุฌุฏูู `take_profit_levels` - ูุณุชููุงุช TP
- โ ุฌุฏูู `stop_losses` - ุฅุนุฏุงุฏุงุช SL
- โ ุฌุฏูู `partial_closes` - ุชุงุฑูุฎ ุงูุฅุบูุงูุงุช
- โ ุชุญุฏูุซุงุช ุนูู ุฌุฏูู `orders`

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### ุฎุทูุงุช ุณุฑูุนุฉ:

1. **ูุฑุงุกุฉ ุงูุฏููู ุงูุดุงูู**: `TP_SL_GUIDE.md`
2. **ูุฑุงุฌุนุฉ ุงูุฃูุซูุฉ**: `examples_tpsl.py`
3. **ุงูุฑุจุท ูุน ุงูุจูุช**: ุงูุธุฑ ุงููุณู ุงูุชุงูู

### ุงูุฑุจุท ูุน ุงูุจูุช ุงูุญุงูู:

ุฃุถู ูุฐุง ุงูููุฏ ูู `bybit_trading_bot.py`:

```python
# ูู ุจุฏุงูุฉ ุงูููู
from order_manager import order_manager, PriceType
from trade_interface import trade_interface  
from bot_integration import bot_integration

# ูู ุฏุงูุฉ main() ุจุนุฏ ุฅุนุฏุงุฏ application
async def start_monitoring():
    """ุจุฏุก ูุธุงู ุงููุฑุงูุจุฉ"""
    await bot_integration.load_managed_orders_from_db()
    await bot_integration.start_price_monitoring(trading_bot.bybit_api)

# ุฅุถุงูุฉ post_init
application.post_init = start_monitoring

# ูู handle_callbackุ ุฅุถุงูุฉ ูุนุงูุฌุงุช ุฌุฏูุฏุฉ
if data.startswith("trade_"):
    # ูุนุงูุฌุฉ ุฃุฒุฑุงุฑ ูุงุฌูุฉ ุงูุชุฏุงูู
    if data == "trade_add_tp":
        await trade_interface.handle_add_take_profit(update, context)
    elif data == "trade_add_sl":
        await trade_interface.handle_add_stop_loss(update, context)
    elif data.startswith("trade_tp_type_"):
        price_type = data.replace("trade_tp_type_", "")
        await trade_interface.handle_tp_type_selection(update, context, price_type)
    # ... ุฅุถุงูุฉ ุจุงูู ุงููุนุงูุฌุงุช
```

## ๐ฏ ูุซุงู ุณุฑูุน

```python
from order_manager import order_manager

# ุฅูุดุงุก ุตููุฉ ูุน TP/SL
order = order_manager.create_managed_order(
    order_id="BTC_001",
    user_id=123456,
    symbol="BTCUSDT",
    side="buy",
    entry_price=50000.0,
    quantity=0.1,
    take_profits=[
        {
            'level': 1,
            'price_type': 'percentage',
            'value': 5.0,  # +5%
            'close_percentage': 50.0
        },
        {
            'level': 2,
            'price_type': 'percentage',
            'value': 10.0,  # +10%
            'close_percentage': 50.0
        }
    ],
    stop_loss={
        'price_type': 'percentage',
        'value': 2.0,  # -2%
        'trailing': False
    }
)

# ุชุญุฏูุซ ุงูุณุนุฑ
result = order.update_price(52500.0)  # ุณูุชู ุชูุนูู TP1

if result['triggered']:
    print(f"ุชู ุชูุนูู {result['type']}!")
```

## ๐ง ุงูุชูููู

### ูุชุทูุจุงุช ุงูุชุดุบูู:
- Python 3.8+
- ุฌููุน ุงููุชุทูุจุงุช ูู `requirements.txt`
- ูุงุนุฏุฉ ุจูุงูุงุช SQLite (ูุชู ุฅูุดุงุคูุง ุชููุงุฆูุงู)

### ุงูุฅุนุฏุงุฏุงุช:
- **ุชุฑุฏุฏ ุงููุฑุงูุจุฉ**: 10 ุซูุงูู (ูููู ุชุนุฏููู ูู `bot_integration.py`)
- **ุงูุชูุจููุงุช**: ุชููุงุฆูุฉ ุนูุฏ ุชูุนูู TP/SL

## ๐ ุงูุจููุฉ

```
ุงููุธุงู ุงูุฌุฏูุฏ
โ
โโโ order_manager.py
โ   โโโ ManagedOrder: ุฅุฏุงุฑุฉ ุตููุฉ ูุงุญุฏุฉ
โ   โโโ TakeProfitLevel: ูุณุชูู TP
โ   โโโ StopLoss: ุฅุนุฏุงุฏุงุช SL
โ   โโโ OrderManager: ุฅุฏุงุฑุฉ ุฌููุน ุงูุตููุงุช
โ
โโโ trade_interface.py
โ   โโโ TradeInterface: ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุชูุงุนููุฉ
โ
โโโ bot_integration.py
โ   โโโ start_price_monitoring(): ูุฑุงูุจุฉ ุงูุฃุณุนุงุฑ
โ   โโโ handle_triggered_event(): ูุนุงูุฌุฉ TP/SL
โ   โโโ load_managed_orders_from_db(): ุชุญููู ุงูุจูุงูุงุช
โ
โโโ database.py (ูุญุฏูุซ)
    โโโ take_profit_levels
    โโโ stop_losses
    โโโ partial_closes
```

## ๐ ุงุณุชุฑุงุชูุฌูุงุช ููุตู ุจูุง

### 1. Conservative (ูุญุงูุธ)
```
TP1: +2% (50%)
TP2: +5% (50%)
SL: -1.5%
```

### 2. Balanced (ูุชูุงุฒู)
```
TP1: +3% (33%)
TP2: +6% (33%)
TP3: +10% (34%)
SL: -2%
```

### 3. Aggressive (ุนุฏูุงูู)
```
TP1: +5% (25%)
TP2: +10% (25%)
TP3: +15% (50%)
SL: -3%
```

## โ ุงุฎุชุจุงุฑ ุงููุธุงู

```bash
# ุชุดุบูู ุงูุฃูุซูุฉ
python examples_tpsl.py

# ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช
python -c "from database import db_manager; print('โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ')"

# ุงุฎุชุจุงุฑ order_manager
python -c "from order_manager import order_manager; print('โ ูุฏูุฑ ุงูุตููุงุช ุฌุงูุฒ')"
```

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "ุงูุตููุฉ ุบูุฑ ููุฌูุฏุฉ"
**ุงูุญู**: ุชุฃูุฏ ูู ุงุณุชุฏุนุงุก `create_managed_order` ูุจู `update_price`

### ุงููุดููุฉ: "TP/SL ูู ูุชู ุชูุนููู"
**ุงูุญู**: 
1. ุชุญูู ูู ุฃู `start_price_monitoring` ูุนูู
2. ุฑุงุฌุน logs: `trading_bot.log`
3. ุชุฃูุฏ ูู ุตุญุฉ ุงูุณุนุฑ ุงููุณุชูุฏู

### ุงููุดููุฉ: ุฎุทุฃ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
**ุงูุญู**: ุงุญุฐู `trading_bot.db` ูุฃุนุฏ ุชุดุบูู ุงูุจูุช

## ๐ ุงูุฅุญุตุงุฆูุงุช

- โ **6 ูููุงุช** ุฌุฏูุฏุฉ
- โ **3 ุฌุฏุงูู** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ **10+ ูุธุงุฆู** ุฑุฆูุณูุฉ
- โ **6 ุฃูุซูุฉ** ุนูููุฉ
- โ ุฏุนู ูุงูู ูู **Spot** ู **Futures**

## ๐ฎ ุงูุชุทููุฑุงุช ุงููุณุชูุจููุฉ

- [ ] Trailing Stop ูุชูุฏู
- [ ] Break-even ุชููุงุฆู
- [ ] OCO (One-Cancels-Other)
- [ ] ูุงุฌูุฉ ููุจ
- [ ] ุชุญูููุงุช ูุชูุฏูุฉ

## ๐ก ูุตุงุฆุญ

1. **ุงุจุฏุฃ ุจุตููุงุช ุตุบูุฑุฉ** ูุงุฎุชุจุงุฑ ุงููุธุงู
2. **ุงุณุชุฎุฏู SL ุฏุงุฆูุงู** ูุญูุงูุฉ ุฑุฃุณ ุงููุงู
3. **ุฑุงูุจ logs ุงูุจูุช** ูุชุชุจุน ุงูุชูููุฐ
4. **ุงุฎุชุจุฑ ูู ุงูุญุณุงุจ ุงูุชุฌุฑูุจู** ุฃููุงู

## ๐ ุงูุฏุนู

- ๐ ุงูุฑุฃ: `TP_SL_GUIDE.md`
- ๐ป ุฃูุซูุฉ: `examples_tpsl.py`
- ๐ Logs: `trading_bot.log`

## โ๏ธ ุฅุฎูุงุก ุงููุณุคูููุฉ

ูุฐุง ุงููุธุงู ููุฃุบุฑุงุถ ุงูุชุนููููุฉ. ุงูุชุฏุงูู ููุทูู ุนูู ูุฎุงุทุฑ. ุงุณุชุฎุฏูู ุนูู ูุณุคูููุชู ุงูุฎุงุตุฉ.

---

**ุชู ุจูุฌุงุญ! ๐**

ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู. ุฑุงุฌุน `TP_SL_GUIDE.md` ููุชูุงุตูู ุงููุงููุฉ.

