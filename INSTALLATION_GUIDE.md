# دليل التثبيت والتشغيل - Bybit Trading Bot

## المتطلبات الأساسية

### 1. Python
- Python 3.8 أو أحدث
- pip (مدير الحزم)

### 2. المكتبات المطلوبة
```bash
pip install -r requirements.txt
```

### 3. حساب Bybit
- حساب على منصة Bybit
- API Key و API Secret

## خطوات التثبيت

### الخطوة 1: تحميل المشروع
```bash
git clone https://github.com/yourusername/botbybit.git
cd botbybit
```

### الخطوة 2: تثبيت المتطلبات
```bash
pip install -r requirements.txt
```

### الخطوة 3: إعداد الإعدادات

#### إنشاء ملف .env
انسخ `env.example` إلى `.env` وقم بتعبئة البيانات:
```env
TELEGRAM_TOKEN=YOUR_TELEGRAM_BOT_TOKEN
ADMIN_USER_ID=YOUR_TELEGRAM_USER_ID
BYBIT_API_KEY=YOUR_BYBIT_API_KEY
BYBIT_API_SECRET=YOUR_BYBIT_API_SECRET
```

#### أو تحديث config.py مباشرة
```python
TELEGRAM_TOKEN = "YOUR_TELEGRAM_BOT_TOKEN"
ADMIN_USER_ID = YOUR_TELEGRAM_USER_ID
BYBIT_API_KEY = "YOUR_BYBIT_API_KEY"
BYBIT_API_SECRET = "YOUR_BYBIT_API_SECRET"
```

### الخطوة 4: تشغيل البوت
```bash
python app.py
```

## استخدام البوت

### 1. البدء في Telegram
- افتح Telegram
- ابحث عن البوت الخاص بك
- أرسل الأمر `/start`

### 2. إعداد الحساب
1. اختر نوع الحساب (تجريبي/حقيقي)
2. اختر نوع السوق (Spot/Futures)
3. حدد مبلغ التداول
4. حدد الرافعة المالية (للفيوتشر)

### 3. ربط API (للحساب الحقيقي)
1. اضغط على "ربط API"
2. أدخل API Key
3. أدخل API Secret
4. اختبر الاتصال

### 4. الحصول على رابط Webhook
1. اضغط على "رابط الإشارات"
2. انسخ الرابط
3. استخدمه في TradingView

## الأزرار والقوائم

### القائمة الرئيسية
- **اختيار المنصة**: ربط حسابك مع Bybit
- **مبلغ التداول**: تحديد مبلغ كل صفقة
- **نوع السوق**: Spot أو Futures
- **نوع الحساب**: Demo أو Real
- **تطبيق تلقائي TP/SL**: إعدادات الربح والخسارة
- **إدارة المخاطر**: حماية رأس المال
- **رابط الإشارات**: للربط مع TradingView
- **تشغيل/إيقاف البوت**: التحكم في حالة البوت

### قائمة إدارة المخاطر
- **تفعيل/إلغاء إدارة المخاطر**
- **حد الخسارة المئوي**
- **حد الخسارة بالمبلغ**
- **الحد اليومي للخسارة**
- **الحد الأسبوعي للخسارة**
- **إيقاف التداول عند الخسارة**
- **عرض الإحصائيات**

### قائمة التطبيق التلقائي
- **تفعيل/تعطيل التطبيق التلقائي**
- **تعديل الإعدادات**
  - أهداف الربح (TP)
  - وقف الخسارة (SL)
  - Trailing Stop
- **إعداد سريع**

## استخدام TradingView

### 1. إنشاء Alert في TradingView
```javascript
// مثال لرسالة Alert
{
  "signal": "buy",
  "symbol": "BTCUSDT",
  "id": "TV_001"
}
```

### 2. الإشارات المدعومة
- `buy` أو `long`: فتح صفقة شراء
- `sell` أو `short`: فتح صفقة بيع  
- `close`: إغلاق الصفقة بالكامل
- `partial_close`: إغلاق جزئي (مع نسبة مئوية)

### 3. مثال Alert كامل
```json
{
  "signal": "buy",
  "symbol": "{{ticker}}",
  "price": "{{close}}",
  "id": "STRATEGY_001"
}
```

## استكشاف الأخطاء

### المشكلة: البوت لا يستجيب
**الحل:**
1. تأكد من تشغيل `app.py`
2. تحقق من صحة `TELEGRAM_TOKEN`
3. راجع `trading_bot.log` للأخطاء

### المشكلة: API Error
**الحل:**
1. تأكد من صحة API Key و API Secret
2. تحقق من صلاحيات API على Bybit:
   - Read
   - Write  
   - Trade
3. تأكد من عدم انتهاء صلاحية API

### المشكلة: الإشارات لا تعمل
**الحل:**
1. تحقق من تفعيل البوت (زر تشغيل/إيقاف)
2. تأكد من صحة رابط Webhook
3. تحقق من تنسيق رسالة Alert

### المشكلة: الأزرار لا تعمل
**الحل:**
1. أعد تشغيل البوت
2. أرسل `/start` مرة أخرى
3. تحقق من السجلات

## الملفات الهامة

### السجلات
- `trading_bot.log`: سجل جميع العمليات
- يتم تحديث السجل تلقائياً

### قاعدة البيانات
- `trading_bot.db`: قاعدة بيانات SQLite
- تحتوي على بيانات المستخدمين والصفقات
- يتم إنشاؤها تلقائياً عند أول تشغيل

### ملفات JSON
- `spot_pairs.json`: أزواج التداول الفوري
- `futures_pairs.json`: أزواج العقود الآجلة
- `popular_pairs.json`: الأزواج الأكثر تداولاً

## نصائح للاستخدام

### 1. ابدأ بالحساب التجريبي
- اختبر الاستراتيجية أولاً
- تعلم كيفية استخدام البوت
- لا مخاطرة على رأس المال

### 2. استخدم إدارة المخاطر
- حدد حد أقصى للخسارة اليومية
- استخدم Stop Loss دائماً
- لا تخاطر بأكثر من 1-2% من رأس المال في كل صفقة

### 3. راقب السجلات
- راجع `trading_bot.log` بانتظام
- انتبه للأخطاء والتحذيرات
- تحقق من تنفيذ الصفقات

### 4. اختبر الإشارات
- أرسل إشارة اختبارية يدوياً أولاً
- تحقق من تنفيذها بشكل صحيح
- ثم فعّل التطبيق التلقائي

## الأمان

### احتياطات مهمة:
1. **لا تشارك API Keys مع أحد**
2. **استخدم IP Whitelist في Bybit**
3. **فعّل Two-Factor Authentication**
4. **حدد صلاحيات API اللازمة فقط**
5. **راجع الصفقات بانتظام**

### توصيات:
- استخدم VPS موثوق للتشغيل 24/7
- احتفظ بنسخة احتياطية من قاعدة البيانات
- راجع الصفقات يومياً
- حدّث API Keys بانتظام

## الدعم

### في حالة وجود مشاكل:
1. راجع `FIXES_APPLIED.md` للتحديثات
2. تحقق من `trading_bot.log`
3. راجع الوثائق في مجلد `docs/` (إن وجد)
4. استخدم الأمر `/help` في البوت

## التحديثات

### للحصول على آخر التحديثات:
```bash
git pull origin main
pip install -r requirements.txt --upgrade
```

---
**آخر تحديث**: 2025-10-28  
**الإصدار**: 3.0.0  
**الحالة**: مستقر ✅

